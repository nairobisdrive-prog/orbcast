{"dependencies":[{"name":"./soapClient","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":7,"column":22,"index":140}}],"key":"VkzcBlVuQw0AjVTd8spY7qDis8k=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  exports.setAVTransportURI = setAVTransportURI;\n  exports.play = play;\n  exports.stop = stop;\n  exports.setVolume = setVolume;\n  exports.startCasting = startCasting;\n  exports.handshakeTest = handshakeTest;\n  var _soapClient = require(_dependencyMap[0], \"./soapClient\");\n  const DEV_MODE = true; // Set to false when testing with real Sonos hardware\n\n  /**\n   * Set the stream URL on a Sonos device (AVTransport).\n   */\n  async function setAVTransportURI(device, streamUrl) {\n    if (DEV_MODE) {\n      console.log(`[Sonos MOCK] SetAVTransportURI → ${device.name}: ${streamUrl}`);\n      return;\n    }\n    await (0, _soapClient.sendSoapCommand)(device.ip, device.port, _soapClient.AVTRANSPORT_PATH, _soapClient.AVTRANSPORT_SERVICE, 'SetAVTransportURI', {\n      InstanceID: 0,\n      CurrentURI: streamUrl,\n      CurrentURIMetaData: ''\n    });\n  }\n\n  /**\n   * Start playback on a Sonos device.\n   */\n  async function play(device) {\n    if (DEV_MODE) {\n      console.log(`[Sonos MOCK] Play → ${device.name}`);\n      return;\n    }\n    await (0, _soapClient.sendSoapCommand)(device.ip, device.port, _soapClient.AVTRANSPORT_PATH, _soapClient.AVTRANSPORT_SERVICE, 'Play', {\n      InstanceID: 0,\n      Speed: 1\n    });\n  }\n\n  /**\n   * Stop playback on a Sonos device.\n   */\n  async function stop(device) {\n    if (DEV_MODE) {\n      console.log(`[Sonos MOCK] Stop → ${device.name}`);\n      return;\n    }\n    await (0, _soapClient.sendSoapCommand)(device.ip, device.port, _soapClient.AVTRANSPORT_PATH, _soapClient.AVTRANSPORT_SERVICE, 'Stop', {\n      InstanceID: 0\n    });\n  }\n\n  /**\n   * Set volume on a Sonos device (0..1 → 0..100 internally).\n   */\n  async function setVolume(device, volume) {\n    if (DEV_MODE) {\n      console.log(`[Sonos MOCK] SetVolume → ${device.name}: ${Math.round(volume * 100)}`);\n      return;\n    }\n    await (0, _soapClient.sendSoapCommand)(device.ip, device.port, _soapClient.RENDERING_PATH, _soapClient.RENDERING_CONTROL_SERVICE, 'SetVolume', {\n      InstanceID: 0,\n      Channel: 'Master',\n      DesiredVolume: Math.round(volume * 100)\n    });\n  }\n\n  /**\n   * Start casting: set URI → play.\n   */\n  async function startCasting(device, streamUrl) {\n    await setAVTransportURI(device, streamUrl);\n    await new Promise(r => setTimeout(r, 300));\n    await play(device);\n  }\n\n  /**\n   * Run a handshake test — checks if the device responds to a GetVolume command.\n   */\n  async function handshakeTest(device) {\n    if (DEV_MODE) {\n      await new Promise(r => setTimeout(r, 800));\n      return `MOCK: ${device.name} (${device.ip}:${device.port}) — handshake OK`;\n    }\n    try {\n      await (0, _soapClient.sendSoapCommand)(device.ip, device.port, _soapClient.RENDERING_PATH, _soapClient.RENDERING_CONTROL_SERVICE, 'GetVolume', {\n        InstanceID: 0,\n        Channel: 'Master'\n      });\n      return `${device.name} — handshake OK`;\n    } catch (e) {\n      return `${device.name} — FAILED: ${e.message}`;\n    }\n  }\n});","lineCount":100,"map":[[7,2,15,0,"exports"],[7,9,15,0],[7,10,15,0,"setAVTransportURI"],[7,27,15,0],[7,30,15,0,"setAVTransportURI"],[7,47,15,0],[8,2,33,0,"exports"],[8,9,33,0],[8,10,33,0,"play"],[8,14,33,0],[8,17,33,0,"play"],[8,21,33,0],[9,2,47,0,"exports"],[9,9,47,0],[9,10,47,0,"stop"],[9,14,47,0],[9,17,47,0,"stop"],[9,21,47,0],[10,2,60,0,"exports"],[10,9,60,0],[10,10,60,0,"setVolume"],[10,19,60,0],[10,22,60,0,"setVolume"],[10,31,60,0],[11,2,75,0,"exports"],[11,9,75,0],[11,10,75,0,"startCasting"],[11,22,75,0],[11,25,75,0,"startCasting"],[11,37,75,0],[12,2,84,0,"exports"],[12,9,84,0],[12,10,84,0,"handshakeTest"],[12,23,84,0],[12,26,84,0,"handshakeTest"],[12,39,84,0],[13,2,1,0],[13,6,1,0,"_soapClient"],[13,17,1,0],[13,20,1,0,"require"],[13,27,1,0],[13,28,1,0,"_dependencyMap"],[13,42,1,0],[14,2,10,0],[14,8,10,6,"DEV_MODE"],[14,16,10,14],[14,19,10,17],[14,23,10,21],[14,24,10,22],[14,25,10,23],[16,2,12,0],[17,0,13,0],[18,0,14,0],[19,2,15,7],[19,17,15,22,"setAVTransportURI"],[19,34,15,39,"setAVTransportURI"],[19,35,16,2,"device"],[19,41,16,21],[19,43,17,2,"streamUrl"],[19,52,17,19],[19,54,18,17],[20,4,19,2],[20,8,19,6,"DEV_MODE"],[20,16,19,14],[20,18,19,16],[21,6,20,4,"console"],[21,13,20,11],[21,14,20,12,"log"],[21,17,20,15],[21,18,20,16],[21,54,20,52,"device"],[21,60,20,58],[21,61,20,59,"name"],[21,65,20,63],[21,70,20,68,"streamUrl"],[21,79,20,77],[21,81,20,79],[21,82,20,80],[22,6,21,4],[23,4,22,2],[24,4,23,2],[24,10,23,8],[24,14,23,8,"sendSoapCommand"],[24,25,23,23],[24,26,23,23,"sendSoapCommand"],[24,41,23,23],[24,43,23,24,"device"],[24,49,23,30],[24,50,23,31,"ip"],[24,52,23,33],[24,54,23,35,"device"],[24,60,23,41],[24,61,23,42,"port"],[24,65,23,46],[24,67,23,48,"AVTRANSPORT_PATH"],[24,78,23,64],[24,79,23,64,"AVTRANSPORT_PATH"],[24,95,23,64],[24,97,23,66,"AVTRANSPORT_SERVICE"],[24,108,23,85],[24,109,23,85,"AVTRANSPORT_SERVICE"],[24,128,23,85],[24,130,23,87],[24,149,23,106],[24,151,23,108],[25,6,24,4,"InstanceID"],[25,16,24,14],[25,18,24,16],[25,19,24,17],[26,6,25,4,"CurrentURI"],[26,16,25,14],[26,18,25,16,"streamUrl"],[26,27,25,25],[27,6,26,4,"CurrentURIMetaData"],[27,24,26,22],[27,26,26,24],[28,4,27,2],[28,5,27,3],[28,6,27,4],[29,2,28,0],[31,2,30,0],[32,0,31,0],[33,0,32,0],[34,2,33,7],[34,17,33,22,"play"],[34,21,33,26,"play"],[34,22,33,27,"device"],[34,28,33,46],[34,30,33,63],[35,4,34,2],[35,8,34,6,"DEV_MODE"],[35,16,34,14],[35,18,34,16],[36,6,35,4,"console"],[36,13,35,11],[36,14,35,12,"log"],[36,17,35,15],[36,18,35,16],[36,41,35,39,"device"],[36,47,35,45],[36,48,35,46,"name"],[36,52,35,50],[36,54,35,52],[36,55,35,53],[37,6,36,4],[38,4,37,2],[39,4,38,2],[39,10,38,8],[39,14,38,8,"sendSoapCommand"],[39,25,38,23],[39,26,38,23,"sendSoapCommand"],[39,41,38,23],[39,43,38,24,"device"],[39,49,38,30],[39,50,38,31,"ip"],[39,52,38,33],[39,54,38,35,"device"],[39,60,38,41],[39,61,38,42,"port"],[39,65,38,46],[39,67,38,48,"AVTRANSPORT_PATH"],[39,78,38,64],[39,79,38,64,"AVTRANSPORT_PATH"],[39,95,38,64],[39,97,38,66,"AVTRANSPORT_SERVICE"],[39,108,38,85],[39,109,38,85,"AVTRANSPORT_SERVICE"],[39,128,38,85],[39,130,38,87],[39,136,38,93],[39,138,38,95],[40,6,39,4,"InstanceID"],[40,16,39,14],[40,18,39,16],[40,19,39,17],[41,6,40,4,"Speed"],[41,11,40,9],[41,13,40,11],[42,4,41,2],[42,5,41,3],[42,6,41,4],[43,2,42,0],[45,2,44,0],[46,0,45,0],[47,0,46,0],[48,2,47,7],[48,17,47,22,"stop"],[48,21,47,26,"stop"],[48,22,47,27,"device"],[48,28,47,46],[48,30,47,63],[49,4,48,2],[49,8,48,6,"DEV_MODE"],[49,16,48,14],[49,18,48,16],[50,6,49,4,"console"],[50,13,49,11],[50,14,49,12,"log"],[50,17,49,15],[50,18,49,16],[50,41,49,39,"device"],[50,47,49,45],[50,48,49,46,"name"],[50,52,49,50],[50,54,49,52],[50,55,49,53],[51,6,50,4],[52,4,51,2],[53,4,52,2],[53,10,52,8],[53,14,52,8,"sendSoapCommand"],[53,25,52,23],[53,26,52,23,"sendSoapCommand"],[53,41,52,23],[53,43,52,24,"device"],[53,49,52,30],[53,50,52,31,"ip"],[53,52,52,33],[53,54,52,35,"device"],[53,60,52,41],[53,61,52,42,"port"],[53,65,52,46],[53,67,52,48,"AVTRANSPORT_PATH"],[53,78,52,64],[53,79,52,64,"AVTRANSPORT_PATH"],[53,95,52,64],[53,97,52,66,"AVTRANSPORT_SERVICE"],[53,108,52,85],[53,109,52,85,"AVTRANSPORT_SERVICE"],[53,128,52,85],[53,130,52,87],[53,136,52,93],[53,138,52,95],[54,6,53,4,"InstanceID"],[54,16,53,14],[54,18,53,16],[55,4,54,2],[55,5,54,3],[55,6,54,4],[56,2,55,0],[58,2,57,0],[59,0,58,0],[60,0,59,0],[61,2,60,7],[61,17,60,22,"setVolume"],[61,26,60,31,"setVolume"],[61,27,60,32,"device"],[61,33,60,51],[61,35,60,53,"volume"],[61,41,60,67],[61,43,60,84],[62,4,61,2],[62,8,61,6,"DEV_MODE"],[62,16,61,14],[62,18,61,16],[63,6,62,4,"console"],[63,13,62,11],[63,14,62,12,"log"],[63,17,62,15],[63,18,62,16],[63,46,62,44,"device"],[63,52,62,50],[63,53,62,51,"name"],[63,57,62,55],[63,62,62,60,"Math"],[63,66,62,64],[63,67,62,65,"round"],[63,72,62,70],[63,73,62,71,"volume"],[63,79,62,77],[63,82,62,80],[63,85,62,83],[63,86,62,84],[63,88,62,86],[63,89,62,87],[64,6,63,4],[65,4,64,2],[66,4,65,2],[66,10,65,8],[66,14,65,8,"sendSoapCommand"],[66,25,65,23],[66,26,65,23,"sendSoapCommand"],[66,41,65,23],[66,43,65,24,"device"],[66,49,65,30],[66,50,65,31,"ip"],[66,52,65,33],[66,54,65,35,"device"],[66,60,65,41],[66,61,65,42,"port"],[66,65,65,46],[66,67,65,48,"RENDERING_PATH"],[66,78,65,62],[66,79,65,62,"RENDERING_PATH"],[66,93,65,62],[66,95,65,64,"RENDERING_CONTROL_SERVICE"],[66,106,65,89],[66,107,65,89,"RENDERING_CONTROL_SERVICE"],[66,132,65,89],[66,134,65,91],[66,145,65,102],[66,147,65,104],[67,6,66,4,"InstanceID"],[67,16,66,14],[67,18,66,16],[67,19,66,17],[68,6,67,4,"Channel"],[68,13,67,11],[68,15,67,13],[68,23,67,21],[69,6,68,4,"DesiredVolume"],[69,19,68,17],[69,21,68,19,"Math"],[69,25,68,23],[69,26,68,24,"round"],[69,31,68,29],[69,32,68,30,"volume"],[69,38,68,36],[69,41,68,39],[69,44,68,42],[70,4,69,2],[70,5,69,3],[70,6,69,4],[71,2,70,0],[73,2,72,0],[74,0,73,0],[75,0,74,0],[76,2,75,7],[76,17,75,22,"startCasting"],[76,29,75,34,"startCasting"],[76,30,75,35,"device"],[76,36,75,54],[76,38,75,56,"streamUrl"],[76,47,75,73],[76,49,75,90],[77,4,76,2],[77,10,76,8,"setAVTransportURI"],[77,27,76,25],[77,28,76,26,"device"],[77,34,76,32],[77,36,76,34,"streamUrl"],[77,45,76,43],[77,46,76,44],[78,4,77,2],[78,10,77,8],[78,14,77,12,"Promise"],[78,21,77,19],[78,22,77,21,"r"],[78,23,77,22],[78,27,77,27,"setTimeout"],[78,37,77,37],[78,38,77,38,"r"],[78,39,77,39],[78,41,77,41],[78,44,77,44],[78,45,77,45],[78,46,77,46],[79,4,78,2],[79,10,78,8,"play"],[79,14,78,12],[79,15,78,13,"device"],[79,21,78,19],[79,22,78,20],[80,2,79,0],[82,2,81,0],[83,0,82,0],[84,0,83,0],[85,2,84,7],[85,17,84,22,"handshakeTest"],[85,30,84,35,"handshakeTest"],[85,31,84,36,"device"],[85,37,84,55],[85,39,84,74],[86,4,85,2],[86,8,85,6,"DEV_MODE"],[86,16,85,14],[86,18,85,16],[87,6,86,4],[87,12,86,10],[87,16,86,14,"Promise"],[87,23,86,21],[87,24,86,23,"r"],[87,25,86,24],[87,29,86,29,"setTimeout"],[87,39,86,39],[87,40,86,40,"r"],[87,41,86,41],[87,43,86,43],[87,46,86,46],[87,47,86,47],[87,48,86,48],[88,6,87,4],[88,13,87,11],[88,22,87,20,"device"],[88,28,87,26],[88,29,87,27,"name"],[88,33,87,31],[88,38,87,36,"device"],[88,44,87,42],[88,45,87,43,"ip"],[88,47,87,45],[88,51,87,49,"device"],[88,57,87,55],[88,58,87,56,"port"],[88,62,87,60],[88,80,87,78],[89,4,88,2],[90,4,89,2],[90,8,89,6],[91,6,90,4],[91,12,90,10],[91,16,90,10,"sendSoapCommand"],[91,27,90,25],[91,28,90,25,"sendSoapCommand"],[91,43,90,25],[91,45,90,26,"device"],[91,51,90,32],[91,52,90,33,"ip"],[91,54,90,35],[91,56,90,37,"device"],[91,62,90,43],[91,63,90,44,"port"],[91,67,90,48],[91,69,90,50,"RENDERING_PATH"],[91,80,90,64],[91,81,90,64,"RENDERING_PATH"],[91,95,90,64],[91,97,90,66,"RENDERING_CONTROL_SERVICE"],[91,108,90,91],[91,109,90,91,"RENDERING_CONTROL_SERVICE"],[91,134,90,91],[91,136,90,93],[91,147,90,104],[91,149,90,106],[92,8,91,6,"InstanceID"],[92,18,91,16],[92,20,91,18],[92,21,91,19],[93,8,92,6,"Channel"],[93,15,92,13],[93,17,92,15],[94,6,93,4],[94,7,93,5],[94,8,93,6],[95,6,94,4],[95,13,94,11],[95,16,94,14,"device"],[95,22,94,20],[95,23,94,21,"name"],[95,27,94,25],[95,44,94,42],[96,4,95,2],[96,5,95,3],[96,6,95,4],[96,13,95,11,"e"],[96,14,95,17],[96,16,95,19],[97,6,96,4],[97,13,96,11],[97,16,96,14,"device"],[97,22,96,20],[97,23,96,21,"name"],[97,27,96,25],[97,41,96,39,"e"],[97,42,96,40],[97,43,96,41,"message"],[97,50,96,48],[97,52,96,50],[98,4,97,2],[99,2,98,0],[100,0,98,1],[100,3]],"functionMap":{"names":["<global>","setAVTransportURI","play","stop","setVolume","startCasting","Promise$argument_0","handshakeTest"],"mappings":"AAA;OCc;CDa;OEK;CFS;OGK;CHQ;OIK;CJU;OKK;oBCE,yBD;CLE;OOK;sBDE,yBC;CPY"},"hasCjsExports":false},"type":"js/module"}]}